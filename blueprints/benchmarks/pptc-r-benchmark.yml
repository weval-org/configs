title: "PPTC-R benchmark: Towards Evaluating the Robustness of Large Language Models for PowerPoint Task Completion"
description: |
  The PPTC-R (PowerPoint Task Completion-Robustness) benchmark evaluates the robustness of Large Language Models (LLMs) in completing complex PowerPoint tasks based on user instructions and adapting to different software versions. It addresses the critical need for understanding LLM robustness in real-world task completion scenarios, moving beyond traditional natural language tasks.

  The benchmark features two main types of perturbations:
  1.  **Adversarial User Instructions**: User instructions are attacked at three levels:
      *   **Sentence-level**: Irrelevant chitchat sentences are added to the original instructions to confuse the LLM.
      *   **Semantic-level**: Original instructions are paraphrased into different expressions while maintaining semantic integrity.
      *   **Language-level**: Original English instructions are translated into 14 non-English languages to test multilingual understanding.
  2.  **Software Version Perturbations**: The number of provided APIs is varied to simulate different software versions:
      *   **API update**: 97 new, unnecessary APIs are introduced to the existing API list to test if LLMs can select correct APIs from a larger pool.
      *   **API lack**: The API list is reduced to 24 basic APIs plus a "Seek for assistance" API, requiring LLMs to identify unresolvable parts of an instruction and request help.

  LLMs are prompted with the user instruction, relevant API descriptions (which vary based on software version perturbation), PPT file content, and dialogue history. They are expected to generate a sequence of API calls to complete the task.

  **Scoring Methodology**:
  LLMs generate sequences of API calls in response to user instructions. An API executor then executes these generated API sequences to produce a PowerPoint prediction file. A PPTX-evaluation system compares this prediction file against a labeled PPT file (representing the correct result). The system assesses if the objects and their position relations in the prediction file match those in the label PPT file. Turn-based accuracy is calculated as the ratio of successfully finished turns to the total number of turns. Session-based accuracy is the ratio of successfully finished sessions to the total number of sessions. For API lack perturbation, the label file is generated by filtering APIs not in the 24 basic APIs and executing the remaining sequence.

  This benchmark is introduced in the paper "PPTC-R benchmark: Towards Evaluating the Robustness of Large Language Models for PowerPoint Task Completion" by Zekai Zhang, Yiduo Guo, Yaobo Liang, Dongyan Zhao, Nan Duan (2024).
author:
  name: Zekai Zhang, Yiduo Guo, Yaobo Liang, Dongyan Zhao, Nan Duan
references:
  - title: "PPTC-R benchmark: Towards Evaluating the Robustness of Large Language Models for PowerPoint Task Completion"
    url: https://arxiv.org/abs/2403.03788
tags:
  - robustness
  - task completion
  - API calls
  - multi-language
  - code generation
  - powerpoint
  - adversarial
models:
  - CORE
---
- id: original-1
  prompt: "Make the title of the new slide \"Marking Standard\" and the body part \"Direct Assessment\" and \"Relative Ranking\"."
  system: |
    You are an AI assistant to help the user to operate PowerPoint and edit the contents.
    Give you the user instruction:<Current user instruction>, you can complete it based on the following APIs and PPT
    file content. Current you are at page <Page id>. Please finish the user instruction with the functions you have. Don't
    generate instructions beyond what the user has instructed. Don't guess what the user may instruct in the next step and
    generete API for them. Don't use python loop to call API. You can only call API once in one line. If the user does not
    specify the page to be modified, you can directly start using the APIs without having to navigate to other pages.
    You need to generate code which can finish the user instruction. The multiple lines of code should be surrounded by
    <code> and </code> such as: <code> API(); API(); </code>
    For example, if the user instruction is "create a slide", then the answer should be:
    <code> create_slide(); </code>
  ideal: "choose_title(); insert_text(\"Marking Standard\"); choose_content(); insert_text(\"Direct Assessment\"); insert_text(\"Relative Ranking\");"
  should:
    - $contains: "insert_text(\"Marking Standard\")"
    - $contains_all_of: ["insert_text(\"Direct Assessment\")", "insert_text(\"Relative Ranking\")"]
    - "The generated API sequence must be executable and produce the correct PowerPoint file state."
- id: sentence-perturb-1
  prompt: "What a lovely day it is today! Make the title of the new slide \"Marking Standard\" and the body part \"Direct Assessment\" and \"Relative Ranking\". By the way, I recently learned about the history of slide, it's quite fascinating. Yes, it's a nice day!"
  system: |
    You are an AI assistant to help the user to operate PowerPoint and edit the contents.
    Give you the user instruction:<Current user instruction>, you can complete it based on the following APIs and PPT
    file content. Current you are at page <Page id>. Please finish the user instruction with the functions you have. Don't
    generate instructions beyond what the user has instructed. Don't guess what the user may instruct in the next step and
    generete API for them. Don't use python loop to call API. You can only call API once in one line. If the user does not
    specify the page to be modified, you can directly start using the APIs without having to navigate to other pages.
    You need to generate code which can finish the user instruction. The multiple lines of code should be surrounded by
    <code> and </code> such as: <code> API(); API(); </code>
    For example, if the user instruction is "create a slide", then the answer should be:
    <code> create_slide(); </code>
  ideal: "choose_title(); insert_text(\"Marking Standard\"); choose_content(); insert_text(\"Direct Assessment\"); insert_text(\"Relative Ranking\");"
  should:
    - $contains: "insert_text(\"Marking Standard\")"
    - $contains_all_of: ["insert_text(\"Direct Assessment\")", "insert_text(\"Relative Ranking\")"]
    - "The API sequence must correctly identify and ignore irrelevant chitchat sentences."
    - "The generated API sequence must be executable and produce the correct PowerPoint file state."
- id: semantic-perturb-2
  prompt: "Position the title element in the bottom corner and input \"Human Assessment\" as its content."
  system: |
    You are an AI assistant to help the user to operate PowerPoint and edit the contents.
    Give you the user instruction:<Current user instruction>, you can complete it based on the following APIs and PPT
    file content. Current you are at page <Page id>. Please finish the user instruction with the functions you have. Don't
    generate instructions beyond what the user has instructed. Don't guess what the user may instruct in the next step and
    generete API for them. Don't use python loop to call API. You can only call API once in one line. If the user does not
    specify the page to be modified, you can directly start using the APIs without having to navigate to other pages.
    You need to generate code which can finish the user instruction. The multiple lines of code should be surrounded by
    <code> and </code> such as: <code> API(); API(); </code>
    For example, if the user instruction is "create a slide", then the answer should be:
    <code> create_slide(); </code>
  ideal: "choose_title(); insert_text(\"Human Assessment\"); set_top(Y_COORD_BOTTOM); set_left(X_COORD_CORNER);"
  should:
    - $contains: "insert_text(\"Human Assessment\")"
    - $contains_all_of: ["set_top(Y_COORD_BOTTOM)", "set_left(X_COORD_CORNER)"]
    - "The generated API sequence must be executable and produce the correct PowerPoint file state."
- id: language-perturb-french-1
  prompt: "Faites le titre de la nouvelle diapositive \"Marquage Standard\" et la partie du corps \"\u00c9valuation Directe\" et \"Classement Relatif\"."
  system: |
    You are an AI assistant to help the user to operate PowerPoint and edit the contents.
    Give you the user instruction:<Current user instruction>, you can complete it based on the following APIs and PPT
    file content. Current you are at page <Page id>. Please finish the user instruction with the functions you have. Don't
    generate instructions beyond what the user has instructed. Don't guess what the user may instruct in the next step and
    generete API for them. Don't use python loop to call API. You can only call API once in one line. If the user does not
    specify the page to be modified, you can directly start using the APIs without having to navigate to other pages.
    You need to generate code which can finish the user instruction. The multiple lines of code should be surrounded by
    <code> and </code> such as: <code> API(); API(); </code>
    For example, if the user instruction is "create a slide", then the answer should be:
    <code> create_slide(); </code>
  ideal: "choose_title(); insert_text(\"Marquage Standard\"); choose_content(); insert_text(\"\u00c9valuation Directe\"); insert_text(\"Classement Relatif\");"
  should:
    - $contains: "insert_text(\"Marquage Standard\")"
    - $contains_all_of: ["insert_text(\"\u00c9valuation Directe\")", "insert_text(\"Classement Relatif\")"]
    - "The generated API sequence must be executable and produce the correct PowerPoint file state."
    - "The model must correctly interpret the French instruction."
- id: api-update-1
  prompt: "Make the title of the new slide \"Project Status\" and add a bulleted list with \"Phase 1 Complete\", \"Phase 2 In Progress\"."
  system: |
    You are an AI assistant to help the user to operate PowerPoint and edit the contents.
    Give you the user instruction:<Current user instruction>, you can complete it based on the following APIs and PPT
    file content. Current you are at page <Page id>. Please finish the user instruction with the functions you have. Don't
    generate instructions beyond what the user has instructed. Don't guess what the user may instruct in the next step and
    generete API for them. Don't use python loop to call API. You can only call API once in one line. If the user does not
    specify the page to be modified, you can directly start using the APIs without having to navigate to other pages.
    You need to generate code which can finish the user instruction. The multiple lines of code should be surrounded by
    <code> and </code> such as: <code> API(); API(); </code>
    For example, if the user instruction is "create a slide", then the answer should be:
    <code> create_slide(); </code>

    (Note: The API list provided to the model includes 97 additional, unnecessary APIs to simulate a version update.)
  ideal: "create_slide(); choose_title(); insert_text(\"Project Status\"); choose_content(); insert_text(\"\u2022 Phase 1 Complete\\n\u2022 Phase 2 In Progress\");"
  should:
    - $contains: "insert_text(\"Project Status\")"
    - $contains_all_of: ["insert_text(\"\u2022 Phase 1 Complete", "insert_text(\"\u2022 Phase 2 In Progress\")"]
    - "The generated API sequence must be executable and produce the correct PowerPoint file state."
    - "The LLM must not be distracted by the presence of new, unnecessary APIs."
- id: api-lack-1
  prompt: "Insert a complex 3D bar chart showing 'Sales Data' for 'Q1, Q2, Q3, Q4' and then set the background color of the slide to 'light blue'."
  system: |
    You are an AI assistant to help the user to operate PowerPoint and edit the contents.
    Give you the user instruction:<Current user instruction>, you can complete it based on the following APIs and PPT
    file content. Current you are at page <Page id>. Please finish the user instruction with the functions you have. Don't
    generate instructions beyond what the user has instructed. Don't guess what the user may instruct in the next step and
    generete API for them. Don't use python loop to call API. You can only call API once in one line. If the user does not
    specify the page to be modified, you can directly start using the APIs without having to navigate to other pages.
    You need to generate code which can finish the user instruction. The multiple lines of code should be surrounded by
    <code> and </code> such as: <code> API(); API(); </code>
    For example, if the user instruction is "create a slide", then the answer should be:
    <code> create_slide(); </code>

    (Note: The API list provided to the model is reduced to 24 basic APIs plus a 'seek_assistance' API.)
  ideal: "seek_assistance(); set_background_color(\"light blue\");"
  should:
    - $contains: "seek_assistance()"
    - $contains: "set_background_color(\"light blue\")"
    - "The generated API sequence must be executable and produce the correct PowerPoint file state."
- id: fig17-api-update-wrong-1
  prompt: "Fill the star with blue color."
  system: |
    You are an AI assistant to help the user to operate PowerPoint and edit the contents.
    Give you the user instruction:<Current user instruction>, you can complete it based on the following APIs and PPT
    file content. Current you are at page <Page id>. Please finish the user instruction with the functions you have. Don't
    generate instructions beyond what the user has instructed. Don't guess what the user may instruct in the next step and
    generete API for them. Don't use python loop to call API. You can only call API once in one line. If the user does not
    specify the page to be modified, you can directly start using the APIs without having to navigate to other pages.
    You need to generate code which can finish the user instruction. The multiple lines of code should be surrounded by
    <code> and </code> such as: <code> API(); API(); </code>
    For example, if the user instruction is "create a slide", then the answer should be:
    <code> create_slide(); </code>

    (Note: The API list provided to the model includes 97 additional, unnecessary APIs to simulate a version update.)
  ideal: "seek_assistance();"
  should:
    - "The generated API sequence must correctly interpret the instruction 'Fill the star with blue color'."
    - "The generated API sequence must only use APIs that are available."
    - "The generated API sequence must be executable and produce the correct PowerPoint file state."
    - $contains: "seek_assistance()"
- id: fig17-api-update-wrong-2
  prompt: "Insert one clock. Make it on the right side."
  system: |
    You are an AI assistant to help the user to operate PowerPoint and edit the contents.
    Give you the user instruction:<Current user instruction>, you can complete it based on the following APIs and PPT
    file content. Current you are at page <Page id>. Please finish the user instruction with the functions you have. Don't
    generate instructions beyond what the user has instructed. Don't guess what the user may instruct in the next step and
    generete API for them. Don't use python loop to call API. You can only call API once in one line. If the user does not
    specify the page to be modified, you can directly start using the APIs without having to navigate to other pages.
    You need to generate code which can finish the user instruction. The multiple lines of code should be surrounded by
    <code> and </code> such as: <code> API(); API(); </code>
    For example, if the user instruction is "create a slide", then the answer should be:
    <code> create_slide(); </code>

    (Note: The API list provided to the model includes 97 additional, unnecessary APIs to simulate a version update.)
  ideal: "insert_picture(\"clock\"); align_slide_right();"
  should:
    - $contains: "insert_picture(\"clock\")"
    - $contains: "align_slide_right()"
    - "The generated API sequence must be executable and produce the correct PowerPoint file state."
    - "The model must use the correct API for inserting a picture."
- id: fig17-sentence-perturb-wrong-1
  prompt: "You know, I've always admired the creativity and innovation behind success-ful business plans. Anyway, go ahead and create a slide and insert the title \"Business Plan\". By the way, have you ever noticed how soothing the color blue can be? It's one of my favorites."
  system: |
    You are an AI assistant to help the user to operate PowerPoint and edit the contents.
    Give you the user instruction:<Current user instruction>, you can complete it based on the following APIs and PPT
    file content. Current you are at page <Page id>. Please finish the user instruction with the functions you have. Don't
    generate instructions beyond what the user has instructed. Don't guess what the user may instruct in the next step and
    generete API for them. Don't use python loop to call API. You can only call API once in one line. If the user does not
    specify the page to be modified, you can directly start using the APIs without having to navigate to other pages.
    You need to generate code which can finish the user instruction. The multiple lines of code should be surrounded by
    <code> and </code> such as: <code> API(); API(); </code>
    For example, if the user instruction is "create a slide", then the answer should be:
    <code> create_slide(); </code>
  ideal: "create_slide(); choose_title(); insert_text(\"Business Plan\");"
  should:
    - $contains: "create_slide()"
    - $contains: "insert_text(\"Business Plan\")"
    - "The API sequence must correctly identify and ignore irrelevant chitchat sentences."
    - "The generated API sequence must be executable and produce the correct PowerPoint file state."
- id: fig17-sentence-perturb-wrong-2
  prompt: "I hope you're having a great day! By the way, the height of the picture should be 2 on slide 6, and it's incredible how technology can help us with these tasks. While you're at it, the font size of all textboxes should be 10 on slide 11. Time flies when you're working on presentations, doesn't it?"
  system: |
    You are an AI assistant to help the user to operate PowerPoint and edit the contents.
    Give you the user instruction:<Current user instruction>, you can complete it based on the following APIs and PPT
    file content. Current you are at page <Page id>. Please finish the user instruction with the functions you have. Don't
    generate instructions beyond what the user has instructed. Don't guess what the user may instruct in the next step and
    generete API for them. Don't use python loop to call API. You can only call API once in one line. If the user does not
    specify the page to be modified, you can directly start using the APIs without having to navigate to other pages.
    You need to generate code which can finish the user instruction. The multiple lines of code should be surrounded by
    <code> and </code> such as: <code> API(); API(); </code>
    For example, if the user instruction is "create a slide", then the answer should be:
    <code> create_slide(); </code>
  ideal: "move_to_slide(6); choose_picture(0); set_height(2); move_to_slide(11); choose_textbox(0); set_font_size(10);"
  should:
    - $contains: "move_to_slide(6); choose_picture(0); set_height(2);"
    - $contains: "move_to_slide(11); choose_textbox(0); set_font_size(10);"
    - "The API sequence must correctly identify and ignore irrelevant chitchat sentences."
    - "The generated API sequence must be executable and produce the correct PowerPoint file state."
- id: original-edit-1
  prompt: "On the current slide, change the font color of the title to 'red' and make it bold."
  system: |
    You are an AI assistant to help the user to operate PowerPoint and edit the contents.
    Give you the user instruction:<Current user instruction>, you can complete it based on the following APIs and PPT
    file content. Current you are at page <Page id>. Please finish the user instruction with the functions you have. Don't
    generate instructions beyond what the user has instructed. Don't guess what the user may instruct in the next step and
    generete API for them. Don't use python loop to call API. You can only call API once in one line. If the user does not
    specify the page to be modified, you can directly start using the APIs without having to navigate to other pages.
    You need to generate code which can finish the user instruction. The multiple lines of code should be surrounded by
    <code> and </code> such as: <code> API(); API(); </code>
    For example, if the user instruction is "create a slide", then the answer should be:
    <code> create_slide(); </code>
  ideal: "choose_title(); set_font_color('red'); set_font_bold();"
  should:
    - $contains: "set_font_color('red')"
    - $contains: "set_font_bold()"
    - "The generated API sequence must be executable and produce the correct PowerPoint file state."